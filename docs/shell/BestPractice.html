

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Best Practice Tips &mdash; Coding Art</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Coding Art" href="../index.html"/>
        <link rel="up" title="Shell" href="index.html"/>
        <link rel="next" title="Extra Docs" href="ExtraDocs.html"/>
        <link rel="prev" title="Calling Commands" href="CallingCommands.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> CodingArt
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../c/index.html">C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/index.html">C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lua/index.html">Lua</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xml/index.html">XML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../json/index.html">JSON</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Shell</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Background.html">Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="Environment.html">Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="Comments.html">Comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="Formatting.html">Formatting</a></li>
<li class="toctree-l2"><a class="reference internal" href="ShFeatures.html">Shell Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="Naming.html">Naming Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="CallingCommands.html">Calling Commands</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Best Practice Tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tip-1">Tip-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-2">Tip-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-3">Tip-3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-4">Tip-4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-5">Tip-5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-6">Tip-6</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-7">Tip-7</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-8">Tip-8</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-9">Tip-9</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-10">Tip-10</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-11">Tip-11</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-12">Tip-12</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-13">Tip-13</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-14">Tip-14</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip-15">Tip-15</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ExtraDocs.html">Extra Docs</a></li>
<li class="toctree-l2"><a class="reference internal" href="End.html">Ending</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../git/index.html">Git Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">Appendix</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">CodingArt</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Shell</a> &raquo;</li>
      
    <li>Best Practice Tips</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="best-practice-tips">
<h1>Best Practice Tips</h1>
<div class="section" id="tip-1">
<span id="sh-best-practice-tip-num-1"></span><h2>Tip-1</h2>
<p>Always set local function variables <code class="docutils literal"><span class="pre">local</span></code>.</p>
</div>
<div class="section" id="tip-2">
<span id="sh-best-practice-tip-num-2"></span><h2>Tip-2</h2>
<p>Write clear code.</p>
<ul class="simple">
<li>never obfuscate what the script is trying to do</li>
<li>never shorten uncessesarily with a lot of commands per LoC chained with a semicolon</li>
</ul>
</div>
<div class="section" id="tip-3">
<span id="sh-best-practice-tip-num-3"></span><h2>Tip-3</h2>
<p>Bash does not have a concept of public and private functions, thus;</p>
<ul class="simple">
<li>public functions get generic names, whereas</li>
<li>private functions are prepended by two underscores (RedHat convention)</li>
</ul>
</div>
<div class="section" id="tip-4">
<span id="sh-best-practice-tip-num-4"></span><h2>Tip-4</h2>
<p>Stick to the <code class="docutils literal"><span class="pre">pushd</span></code>, <code class="docutils literal"><span class="pre">popd</span></code>, and <code class="docutils literal"><span class="pre">dirs</span></code> builtins for
<a class="reference external" href="https://www.gnu.org/software/bash/manual/html_node/Directory-Stack-Builtins.html#Directory-Stack-Builtins">directory stack manipulation</a> where sensible.</p>
</div>
<div class="section" id="tip-5">
<span id="sh-best-practice-tip-num-5"></span><h2>Tip-5</h2>
<p>Use the builtin <code class="docutils literal"><span class="pre">readonly</span></code> when declaring constants and immutable variable.</p>
</div>
<div class="section" id="tip-6">
<span id="sh-best-practice-tip-num-6"></span><h2>Tip-6</h2>
<p>Write generic small check functions instead of large init and clean-up code.</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="c1"># both functions return non-zero on error</span>
<span class="k">function</span> is_valid_string?<span class="o">()</span>
<span class="o">{</span>
    <span class="o">[[</span> <span class="nv">$@</span> <span class="o">=</span>~ ^<span class="o">[</span>A-Za-z0-9<span class="o">]</span>*$ <span class="o">]]</span>
<span class="o">}</span>

<span class="k">function</span> is_integer?<span class="o">()</span>
<span class="o">{</span>
    <span class="o">[[</span> <span class="nv">$@</span> <span class="o">=</span>~ ^-?<span class="o">[</span>0-9<span class="o">]</span>+$ <span class="o">]]</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="tip-7">
<span id="sh-best-practice-tip-num-7"></span><h2>Tip-7</h2>
<p>If a project gets bigger, split it up into smaller files with clear and obvious naming scheme.</p>
</div>
<div class="section" id="tip-8">
<span id="sh-best-practice-tip-num-8"></span><h2>Tip-8</h2>
<p>Clearly document code parts that are not easily understood.</p>
</div>
<div class="section" id="tip-9">
<span id="sh-best-practice-tip-num-9"></span><h2>Tip-9</h2>
<p>Try to stick to <a class="reference external" href="http://www.tldp.org/LDP/abs/html/restricted-sh.html">restricted</a> mode where
sensible and possible to use <code class="docutils literal"><span class="pre">set</span> <span class="pre">-r</span></code>.</p>
<blockquote>
<div><strong>Use with caution</strong>. While this flag is very useful for security sensitive environments, scripts
have to be written with the flag in mind. Adding restricted mode to an existing script will most
likely break it.</div></blockquote>
</div>
<div class="section" id="tip-10">
<span id="sh-best-practice-tip-num-10"></span><h2>Tip-10</h2>
<p>Scripts should somewhat reflect the following general layout, e.g.</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="ch">#!/usr/bin/env bash</span>
<span class="c1">#</span>
<span class="c1"># AUTHORS, LICENSE and DOCUMENTATION</span>
<span class="c1">#</span>
<span class="nb">set</span> -eu -o pipefail

Readonly Variables
Global Variables

Import <span class="o">(</span><span class="s2">&quot;source scriptname&quot;</span><span class="o">)</span> of external <span class="nb">source</span> code

Functions
  - <span class="k">function</span> <span class="nb">local</span> variables
  - clearly describe interfaces: <span class="k">return</span> either a code or string

Main
  - option parsing
  - log file and syslog handling
  - temp. file and named pipe handling
  - signal traps

--------------------------------------------------------------------------
To keep in mind:
  - quoting of all variables passed when executing sub-shells or cli tools.
  - testing of functions, conditionals and flow.
  - makes restricted mode <span class="o">(</span><span class="s2">&quot;set -r&quot;</span><span class="o">)</span> <span class="k">for</span> security sense.
</pre></div>
</div>
</div>
<div class="section" id="tip-11">
<span id="sh-best-practice-tip-num-11"></span><h2>Tip-11</h2>
<p><a class="reference external" href="http://www.linfo.org/rule_of_silence.html">Silence is golden</a>, like in any UNIX programm,
avoid cluttering the terminal with useless output.</p>
</div>
<div class="section" id="tip-12">
<span id="sh-best-practice-tip-num-12"></span><h2>Tip-12</h2>
<p>Overusing <code class="docutils literal"><span class="pre">grep</span></code> and <code class="docutils literal"><span class="pre">grep</span> <span class="pre">-v</span></code>, e.g.</p>
<div class="highlight-sh"><div class="highlight"><pre>ps ax <span class="p">|</span> grep <span class="si">${</span><span class="nv">processname</span><span class="si">}</span> <span class="p">|</span> grep -v grep
</pre></div>
</div>
<p>versus using appropriate userland utilities:</p>
<div class="highlight-sh"><div class="highlight"><pre>pgrep <span class="si">${</span><span class="nv">processname</span><span class="si">}</span>
</pre></div>
</div>
</div>
<div class="section" id="tip-13">
<span id="sh-best-practice-tip-num-13"></span><h2>Tip-13</h2>
<p>Please use <code class="docutils literal"><span class="pre">printf</span></code> instead of <code class="docutils literal"><span class="pre">echo</span></code>.</p>
<p>the bash builtin <code class="docutils literal"><span class="pre">printf</span></code> should be preferred to <code class="docutils literal"><span class="pre">echo</span></code> where possible. It does work like
printf in C or any other high-level language,
also see <a class="reference external" href="http://wiki.bash-hackers.org/commands/builtin/printf">builtin printf</a>.</p>
</div>
<div class="section" id="tip-14">
<span id="sh-best-practice-tip-num-14"></span><h2>Tip-14</h2>
<p>Anonymous Functions, which is also called Lambdas.</p>
<p>Yup, it&#8217;s possible. But you&#8217;ll probably never need them, in case you really do, here&#8217;s how:</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="k">function</span> lambda<span class="o">()</span>
<span class="o">{</span>
    <span class="nv">_f</span><span class="o">=</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="p">;</span>
    <span class="nb">shift</span>
    <span class="k">function</span> _l
    <span class="o">{</span>
        <span class="nb">eval</span> <span class="si">${</span><span class="nv">_f</span><span class="si">}</span><span class="p">;</span>
    <span class="o">}</span>
    _l <span class="si">${</span><span class="p">*</span><span class="si">}</span><span class="p">;</span>
    <span class="nb">unset</span> _l
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="tip-15">
<span id="sh-best-practice-tip-num-15"></span><h2>Tip-15</h2>
<p>Never forget that you cannot put a space/blank around <code class="docutils literal"><span class="pre">=</span></code> during an assignment.</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="c1"># This is not work</span>
<span class="nv">ret</span> <span class="o">=</span> <span class="nb">false</span>

<span class="c1"># This works fine</span>
          <span class="nv">var_1</span><span class="o">=</span>1
     <span class="nv">a_long_var</span><span class="o">=</span>2
<span class="nv">a_very_long_var</span><span class="o">=</span>3
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ExtraDocs.html" class="btn btn-neutral float-right" title="Extra Docs" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="CallingCommands.html" class="btn btn-neutral" title="Calling Commands" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, gkvim.
      Last updated on May 21, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>